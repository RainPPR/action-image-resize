# Action Image Resize ğŸš€

[![GitHub Action](https://img.shields.io/badge/GitHub%20Action-Image--Resize-blue?logo=github)](https://github.com/RainPPR/action-image-resize)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

è¿™æ˜¯ä¸€ä¸ªä¸º **Markdown æ–‡æ¡£ä»“åº“** é‡èº«å®šåšçš„æ·±åº¦å›¾ç‰‡å‹ç¼©ä¸è‡ªåŠ¨åŒ–ç®¡ç†æ–¹æ¡ˆã€‚é€šè¿‡ GitHub Actionï¼Œæœ¬å·¥å…·èƒ½è‡ªåŠ¨å°†ä½å›¾è½¬æ¢ä¸ºç°ä»£çš„ **AVIF** æ ¼å¼ï¼Œå¹¶å¯¹ SVG è¿›è¡Œæé™ä¼˜åŒ–ï¼ŒåŒæ—¶è‡ªåŠ¨åŒæ­¥ä¿®å¤æ‰€æœ‰ Markdown å¼•ç”¨è·¯å¾„ã€‚

---

## ğŸ¯ åº”ç”¨åœºæ™¯ä¸å±€é™æ€§

åœ¨å†³å®šä½¿ç”¨æœ¬é¡¹ç›®å‰ï¼Œè¯·åŠ¡å¿…é˜…è¯»ä»¥ä¸‹è¯´æ˜ï¼š

### **æ¨èåœºæ™¯**

- **ä¸ªäººåšå®¢/æŠ€æœ¯æ–‡æ¡£**ï¼šè¿½æ±‚åŠ è½½é€Ÿåº¦çš„æè‡´ä¼˜åŒ–ã€‚
- **é™æ€èµ„æºæ‰˜ç®¡**ï¼šå¸Œæœ›åœ¨ä¿è¯è§†è§‰æ•ˆæœçš„å‰æä¸‹æœ€å¤§åŒ–èŠ‚çœå­˜å‚¨å’Œ CDN æµé‡ã€‚

### **ä¸æ¨èåœºæ™¯**

- âŒ **æ‘„å½±æˆ–é«˜ä¿çœŸä½œå“é›†**ï¼šæœ¬é¡¹ç›®é»˜è®¤é‡‡ç”¨ `avif` è´¨é‡ `60` ä¸”ä¼šå¼ºåˆ¶å¯¹è¶…å¤§å›¾è¿›è¡Œç¼©æ”¾ï¼Œä¸é€‚åˆå¯¹å›¾åƒç»†èŠ‚æœ‰ä¸¥è‹›è¦æ±‚çš„åœºæ™¯ã€‚
- âŒ **å…¼å®¹æ€§è¦æ±‚æé«˜**ï¼šAVIF åœ¨ææ—§è®¾å¤‡æˆ–æµè§ˆå™¨ä¸Šå¯èƒ½æ— æ³•æ¸²æŸ“ï¼ˆå»ºè®®ç¯å¢ƒï¼šChrome 120+ï¼‰ã€‚
- âŒ **é«˜é¢‘ç‡é‡å¤è¿è¡Œ**ï¼š**è­¦å‘Š**ï¼šæœ¬å·¥å…·ä¼šå¯¹ SVG è¿›è¡Œå¤šæ¬¡æ‰«æé‡å¤å‹ç¼©ã€‚é¢‘ç¹å¯¹åŒä¸€æ‰¹å­˜é‡å›¾ç‰‡è¿è¡Œä¼šæµªè´¹è®¡ç®—èµ„æºï¼Œä¸”å¯èƒ½å¯¼è‡´ SVG ç²¾åº¦åœ¨å¤šæ¬¡é‡é‡‡æ ·ä¸­å—æŸã€‚è¯·åˆç†é…ç½®è§¦å‘è·¯å¾„ã€‚

> [!WARNING]
> å¦‚æœå›¾ç‰‡è·¯å¾„ä¸­æœ‰ç©ºæ ¼ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼Œè¯·å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨è¿™ç±»é—®é¢˜ï¼Œä¿®å¤åå†è¿è¡Œæœ¬è„šæœ¬ï¼Œæˆ–è€…è¿è¡Œåå†æ‰‹åŠ¨æ£€æŸ¥ä¿®å¤ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ä½å›¾å…¨è‡ªåŠ¨è½¬ç **ï¼šè‡ªåŠ¨æ‰«æ `png`, `jpg`, `jpeg`, `webp`, `gif` å¹¶è½¬æ¢ä¸º `avif` æ ¼å¼ã€‚
- **çŸ¢é‡å›¾æé™ä¼˜åŒ–**ï¼šåŸºäº [SVGO](https://github.com/svg/svgo) è¿›è¡Œå¤šè½®é‡å¤æ‰«æï¼Œé’ˆå¯¹ç°ä»£æ˜¾ç¤ºå±ä¼˜åŒ–æµ®ç‚¹ç²¾åº¦ï¼ˆ`2.0`ï¼‰ï¼Œæè‡´ç²¾ç®€ä»£ç ã€‚
- **æ™ºèƒ½ç¼©æ”¾ç­–ç•¥**ï¼šå›¾ç‰‡å®½åº¦ä¸Šé™é™åˆ¶åœ¨ `2560px`ï¼Œè¶…å®½å›¾ç‰‡å°†è‡ªåŠ¨ç­‰æ¯”ç¼©å°ã€‚
- **å¼•ç”¨åŒæ­¥ä¿®å¤**ï¼šè‡ªåŠ¨æ›´æ–° `.md` æ–‡ä»¶ä¸­çš„å›¾ç‰‡åç¼€ï¼Œé¿å…æ‰‹åŠ¨ä¿®æ”¹é“¾æ¥çš„çƒ¦æ¼ã€‚
- **é€æ˜åŒ–æŠ¥å‘Š**ï¼šè¿è¡Œç»“æŸåç”Ÿæˆè¯¦ç»†çš„å‹ç¼©æ•°æ®æŠ¥å‘Šï¼ˆæ”¯æŒ Job Summary å’Œç¯å¢ƒå˜é‡ï¼‰ã€‚
- **å¼€ç®±å³ç”¨**ï¼šåŸºäº Docker (`node:slim`)ï¼Œæ— éœ€æ±¡æŸ“å®¿ä¸»ç¯å¢ƒã€‚

---

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹

åœ¨ä½ çš„ GitHub ä»“åº“ä¸­åˆ›å»º `.github/workflows/image-compress.yml`ï¼š

```yaml
name: Image Compression

on:
  push:
    branches: [ main ]
    paths:
      - '**.png'
      - '**.jpg'
      - '**.jpeg'
      - '**.webp'
      - '**.gif'
      - '**.svg'
  workflow_dispatch:

jobs:
  compress:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Compress Assets
        id: compress_step
        uses: RainPPR/action-image-resize@main
        with:
          # å¯é€‰ï¼šæŒ‡å®šå¤„ç†ç›®å½•ï¼Œä¾‹å¦‚ 'docs'ã€‚é»˜è®¤å¤„ç†å…¨ä»“åº“ã€‚
          path: '.'

      - name: Add PR Summary
        if: github.event_name == 'pull_request'
        uses: mshick/add-pr-comment@v2
        with:
          message: |
            ${{ steps.compress_step.outputs.summary }}

      - name: Commit & Push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: optimize images and update markdown links"
```

---

## ï¿½ è¾“å…¥ä¸è¾“å‡º

### **Inputs**

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
| :--- | :--- | :--- |
| `path` | æŒ‡å®šè¦å¤„ç†çš„å­ç›®å½•ï¼ˆç›¸å¯¹äºæ ¹ç›®å½•ï¼‰ | `.` |

### **Outputs**

| å‚æ•° | è¯´æ˜ |
| :--- | :--- |
| `summary` | åŒ…å« Markdown æ ¼å¼çš„å‹ç¼©æ€»ç»“æŠ¥å‘Š |

### **Environment Variables**

æœ¬ Action ä¼šè‡ªåŠ¨æ³¨å…¥ç¯å¢ƒå˜é‡ `IMAGE_COMPRESSION_SUMMARY`ï¼Œå†…å®¹åŒ `summary` è¾“å‡ºï¼Œæ–¹ä¾¿åœ¨åç»­æ­¥éª¤ä¸­ç›´æ¥å¼•ç”¨ã€‚

---

## ğŸ› ï¸ æŠ€æœ¯åŸç†

1. **æ‰«æé˜¶æ®µ**ï¼šé€’å½’æ£€ç´¢æŒ‡å®šç›®å½•ä¸‹çš„ä½å›¾ä¸ SVG æ–‡ä»¶ã€‚
2. **Sharp è½¬ç **ï¼š
   - æ£€æŸ¥å®½åº¦ï¼Œè‹¥ > 2560 åˆ™è¿›è¡Œ `resize` å¤„ç†ã€‚
   - è½¬æ¢ä¸º `avif` æ ¼å¼ï¼ˆè´¨é‡ 60ï¼‰ï¼Œåˆ é™¤åŸå›¾ã€‚
3. **SVGO ä¼˜åŒ–**ï¼š
   - æ‰§è¡Œ `multipass` å¤šè½®ä¼˜åŒ–ã€‚
   - æ¸…ç†æ‰€æœ‰éæ ¸å¿ƒå…ƒæ•°æ®åŠå†—ä½™æ ·å¼ã€‚
4. **è·¯å¾„åŒæ­¥**ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ `/\.(png|jpg|jpeg|webp|gif)(?=[)\s"']|$)/gi` ç²¾å‡†åŒ¹é… Markdown ä¸­çš„è·¯å¾„å¹¶æ›´æ–°ä¸º `.avif`ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

- **åŸåœ°ä¿®æ”¹**ï¼šæœ¬å·¥å…·ä¼šç›´æ¥ä¿®æ”¹/åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ã€‚**è¯·åŠ¡å¿…é…åˆ Git æäº¤é€»è¾‘ä½¿ç”¨**ã€‚
- **SVG æŸè€—**ï¼šæé™å‹ç¼©åçš„ SVG æµ®ç‚¹æ•°ç²¾åº¦ä¸º 1~2 ä½ï¼Œåœ¨å¸¸è§„æ˜¾ç¤ºå™¨ä¸‹æ— æ„Ÿï¼Œä½†è¯·å‹¿ç”¨äºé«˜ç²¾åº¦çŸ¢é‡ç¼–è¾‘æºæ–‡ä»¶ã€‚

---

## ğŸ¤ è´¡çŒ®ä¸åé¦ˆ

æœ¬é¡¹ç›®ç”±å¼€å‘è€… `RainPPR` ç‹¬ç«‹ç»´æŠ¤ã€‚

- **ç°çŠ¶è¯´æ˜**ï¼šç”±äºä¸ªäººç²¾åŠ›å’Œé¡¹ç›®å®šä½åŸå› ï¼Œæœ¬é¡¹ç›®æ—¨åœ¨è§£å†³ç‰¹å®šéœ€æ±‚ã€‚**æš‚ä¸æ¥å—**å¤§è§„æ¨¡çš„åŠŸèƒ½å¢å¼ºè¯·æ±‚ï¼ˆFeature Requestï¼‰ã€‚
- **æ¬¢è¿åé¦ˆ**ï¼šå¦‚æœæ‚¨åœ¨ä½¿ç”¨ä¸­å‘ç°äº† Bugã€æ‰“å­—ç¨¿é”™è¯¯æˆ–æ˜¯æ›´å¥½çš„ä¼˜åŒ–æ€è·¯ï¼Œéå¸¸æ¬¢è¿æäº¤ Issue æˆ– Pull Requestï¼Œæˆ‘å°†ä¸èƒœè£å¹¸ã€‚

---

## ğŸ“„ è®¸å¯è¯

åŸºäº [MIT License](LICENSE) è®¸å¯åè®®ã€‚

---

> [!NOTE]
> æœ¬æ–‡ä»¶ç”± **Antigravity (Gemini 3 Flash)** ç”Ÿæˆï¼Œå¹¶ç”± **RainPPR** è¿›è¡Œäº†äººå·¥éªŒæ”¶ä¸å¾®è°ƒã€‚
